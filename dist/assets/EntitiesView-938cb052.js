import{d as H,l as E,m as F,u as G,b as K,r as i,e as W,q as A,s as J,f as c,o as L,c as Q,h as o,i as a,w as s,x as y,t as f,v as d,g as T,E as X,_ as Y}from"./index-985400ba.js";const k=()=>({entity:"",values:"",fuzzy_match:"",assistant_id:""}),Z={class:"row"},ee={class:"col-12"},te={class:"card box-margin"},ae={class:"card-body"},le={class:"row my-3"},oe={class:"col-sm-12 col-md-5"},se={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ne={class:"col-sm-12 col-md-7"},ie={class:"basic-table-area"},ue={class:"row my-3"},de={class:"col-sm-12 col-md-5"},re={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ce={class:"col-sm-12 col-md-7"},me={class:"dialog-footer"},ve=H({__name:"EntitiesView",setup(pe){const B=E("$formatDate"),$=E("$deepCopy"),l=F();G(),K();const n=i([]),m=i(k()),z=i(k());i({});const r=i(1);i(0);const D=i(["entity"]),b=i(""),h=i(!1),x=i(null),p=i(-1),_=i(!1),I=W(()=>p.value===-1?"Crear Entitiy":"Editar Entitiy");A(b,()=>{clearTimeout(x.value),x.value=setTimeout(()=>{r.value=1,g(r.value)},600)}),J(()=>{g()});async function g(u=1){let e={page:r.value||u,search:b.value,fieldsToSearch:D.value,sort:"updated_at",order:"desc"};await Promise.all([l.dispatch("entitiesModule/list",e)]),n.value=$(l.state.entitiesModule.entities)}async function N(){if(h.value=!0,p.value>-1){let u=n.value[p.value]._id;try{await l.dispatch("entitiesModule/update",{id:u,data:m.value}),Object.assign(n.value[p.value],m.value),V()}finally{h.value=!1}}else try{let u=await l.dispatch("entitiesModule/create",m.value);n.value.push(u),V(),g()}finally{h.value=!1}}function O(u){p.value=n.value.indexOf(u),m.value=Object.assign({},u),_.value=!0}async function U(u){const e=n.value.indexOf(u);let v=n.value[e]._id;await X.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await l.dispatch("entitiesModule/delete",v),n.value.splice(e,1))}async function V(){_.value=!1,setTimeout(()=>{m.value=Object.assign({},z.value),p.value=-1},300)}return(u,e)=>{const v=c("el-button"),M=c("el-pagination"),w=c("el-table-column"),P=c("el-input"),j=c("el-table"),S=c("el-form-item"),R=c("el-form"),q=c("el-dialog");return L(),Q("div",Z,[o("div",ee,[o("div",te,[o("div",ae,[a(v,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:e[0]||(e[0]=t=>{V(),_.value=!0})},{default:s(()=>[y(" Crear Entitiy ")]),_:1}),o("div",le,[o("div",oe,[o("div",se,"Mostrando "+f(d(l).state.itemsPerPage>n.value.length?n.value.length:d(l).state.itemsPerPage)+" de "+f(d(l).state.entitiesModule.total)+" registros",1)]),o("div",ne,[a(M,{"current-page":r.value,"onUpdate:currentPage":e[1]||(e[1]=t=>r.value=t),onCurrentChange:e[2]||(e[2]=t=>g(r.value)),background:"",layout:"pager",total:d(l).state.entitiesModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),o("div",ie,[T("Basic Table"),a(j,{border:"",stripe:"",data:n.value,style:{width:"100%"}},{default:s(()=>[a(w,{label:"Fecha actualización",prop:"created_at"},{default:s(t=>[o("span",null,f(d(B)(t.row.updated_at,"dd/MM/yyyy HH:mm")),1)]),_:1}),a(w,{label:"Nombre",prop:"entity"}),a(w,{label:"Valores",prop:"values"},{default:s(t=>{var C;return[o("span",null,f((C=t.row.values)==null?void 0:C.length),1)]}),_:1}),a(w,{align:"right"},{header:s(()=>[a(P,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:s(t=>[a(v,{size:"small",type:"primary",onClick:C=>O(t.row)},{default:s(()=>[y("Editar")]),_:2},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:C=>U(t.row)},{default:s(()=>[y("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),T("End Basic Table")]),o("div",ue,[o("div",de,[o("div",re,"Mostrando "+f(d(l).state.itemsPerPage>n.value.length?n.value.length:d(l).state.itemsPerPage)+" de "+f(d(l).state.entitiesModule.total)+" registros",1)]),o("div",ce,[a(M,{"current-page":r.value,"onUpdate:currentPage":e[4]||(e[4]=t=>r.value=t),onCurrentChange:e[5]||(e[5]=t=>g(r.value)),background:"",layout:"pager",total:d(l).state.entitiesModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),a(q,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=t=>_.value=t),title:I.value,width:"30%"},{footer:s(()=>[o("span",me,[a(v,{plain:"",type:"danger",onClick:e[7]||(e[7]=t=>_.value=!1)},{default:s(()=>[y("Cancelar")]),_:1}),a(v,{type:"success",onClick:N,loading:h.value},{default:s(()=>[y(" Guardar ")]),_:1},8,["loading"])])]),default:s(()=>[a(R,{"label-position":"top","label-width":"100px"},{default:s(()=>[a(S,{label:"Nombre"},{default:s(()=>[a(P,{modelValue:m.value.entity,"onUpdate:modelValue":e[6]||(e[6]=t=>m.value.entity=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),fe=Y(ve,[["__file","D:/programming/Work/Databot/databot_ia_frontend/src/views/EntitiesView.vue"]]);export{fe as default};
