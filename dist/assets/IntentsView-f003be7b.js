import{d as H,l as I,m as F,u as G,b as K,r as i,e as A,q as J,s as L,f as p,o as Q,c as W,h as o,i as a,w as n,x as y,t as f,v as u,g as k,E as X,_ as Y}from"./index-7e64b160.js";const B=()=>({intent:"",examples:"",description:""}),Z={class:"row"},ee={class:"col-12"},te={class:"card box-margin"},ae={class:"card-body"},le={class:"row my-3"},oe={class:"col-sm-12 col-md-5"},ne={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},se={class:"col-sm-12 col-md-7"},ie={class:"basic-table-area"},de={class:"row my-3"},ue={class:"col-sm-12 col-md-5"},re={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ce={class:"col-sm-12 col-md-7"},pe={class:"dialog-footer"},me=H({__name:"IntentsView",setup(ve){const $=I("$formatDate"),z=I("$deepCopy"),l=F();G(),K();const s=i([]),r=i(B()),D=i(B());i({});const c=i(1);i(0);const E=i(["intent"]),w=i(""),C=i(!1),P=i(null),v=i(-1),_=i(!1),j=A(()=>v.value===-1?"Crear Intent":"Editar Intent");J(w,()=>{clearTimeout(P.value),P.value=setTimeout(()=>{c.value=1,g(c.value)},600)}),L(()=>{g()});async function g(d=1){let e={page:c.value||d,search:w.value,fieldsToSearch:E.value,sort:"updated_at",order:"desc"};await Promise.all([l.dispatch("intentsModule/list",e)]),s.value=z(l.state.intentsModule.intents)}async function N(){if(C.value=!0,v.value>-1){let d=s.value[v.value]._id;try{await l.dispatch("intentsModule/update",{id:d,data:r.value}),Object.assign(s.value[v.value],r.value),x()}finally{C.value=!1}}else try{let d=await l.dispatch("intentsModule/create",r.value);s.value.push(d),x(),g()}finally{C.value=!1}}function O(d){v.value=s.value.indexOf(d),r.value=Object.assign({},d),_.value=!0}async function U(d){const e=s.value.indexOf(d);let m=s.value[e]._id;await X.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await l.dispatch("intentsModule/delete",m),s.value.splice(e,1))}async function x(){_.value=!1,setTimeout(()=>{r.value=Object.assign({},D.value),v.value=-1},300)}return(d,e)=>{const m=p("el-button"),M=p("el-pagination"),b=p("el-table-column"),V=p("el-input"),S=p("el-table"),T=p("el-form-item"),R=p("el-form"),q=p("el-dialog");return Q(),W("div",Z,[o("div",ee,[o("div",te,[o("div",ae,[a(m,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:e[0]||(e[0]=t=>{x(),_.value=!0})},{default:n(()=>[y(" Crear Intent ")]),_:1}),o("div",le,[o("div",oe,[o("div",ne,"Mostrando "+f(u(l).state.itemsPerPage>s.value.length?s.value.length:u(l).state.itemsPerPage)+" de "+f(u(l).state.intentsModule.total)+" registros",1)]),o("div",se,[a(M,{"current-page":c.value,"onUpdate:currentPage":e[1]||(e[1]=t=>c.value=t),onCurrentChange:e[2]||(e[2]=t=>g(c.value)),background:"",layout:"pager",total:u(l).state.intentsModule.total,"page-size":u(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),o("div",ie,[k("Basic Table"),a(S,{border:"",stripe:"",data:s.value,style:{width:"100%"}},{default:n(()=>[a(b,{label:"Fecha actualización",prop:"created_at"},{default:n(t=>[o("span",null,f(u($)(t.row.updated_at,"dd/MM/yyyy HH:mm")),1)]),_:1}),a(b,{label:"Nombre",prop:"intent"}),a(b,{label:"Descripción",prop:"description"}),a(b,{label:"Ejemplos",prop:"examples"},{default:n(t=>{var h;return[o("span",null,f((h=t.row.examples)==null?void 0:h.length),1)]}),_:1}),a(b,{align:"right"},{header:n(()=>[a(V,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:n(t=>[a(m,{size:"small",type:"primary",onClick:h=>O(t.row)},{default:n(()=>[y("Editar")]),_:2},1032,["onClick"]),a(m,{size:"small",type:"danger",onClick:h=>U(t.row)},{default:n(()=>[y("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),k("End Basic Table")]),o("div",de,[o("div",ue,[o("div",re,"Mostrando "+f(u(l).state.itemsPerPage>s.value.length?s.value.length:u(l).state.itemsPerPage)+" de "+f(u(l).state.intentsModule.total)+" registros",1)]),o("div",ce,[a(M,{"current-page":c.value,"onUpdate:currentPage":e[4]||(e[4]=t=>c.value=t),onCurrentChange:e[5]||(e[5]=t=>g(c.value)),background:"",layout:"pager",total:u(l).state.intentsModule.total,"page-size":u(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),a(q,{modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=t=>_.value=t),title:j.value,width:"30%"},{footer:n(()=>[o("span",pe,[a(m,{plain:"",type:"danger",onClick:e[8]||(e[8]=t=>_.value=!1)},{default:n(()=>[y("Cancelar")]),_:1}),a(m,{type:"success",onClick:N,loading:C.value},{default:n(()=>[y(" Guardar ")]),_:1},8,["loading"])])]),default:n(()=>[a(R,{"label-position":"top","label-width":"100px"},{default:n(()=>[a(T,{label:"Nombre"},{default:n(()=>[a(V,{modelValue:r.value.intent,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.intent=t)},null,8,["modelValue"])]),_:1}),a(T,{label:"Descripción"},{default:n(()=>[a(V,{type:"textarea",autosize:"",modelValue:r.value.description,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.description=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),fe=Y(me,[["__file","D:/Programacion/Trabajo/Databot/vue3_ts_skeleton/src/views/IntentsView.vue"]]);export{fe as default};
