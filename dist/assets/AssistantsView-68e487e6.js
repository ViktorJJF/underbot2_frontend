import{d as q,l as R,m as W,u as F,b as G,r as u,e as K,q as H,s as J,f as m,o as L,c as Q,h as n,t as k,v as d,i as t,g as M,w as s,x as V,E as X,_ as Y}from"./index-7e64b160.js";const B=()=>({name:"",watson_skill_id:"",watson_api_key:"",bot_id:0,webhooks:[{headers:[],name:"main_webhook",url:""}]}),Z={class:"row"},ee={class:"col-12"},ae={class:"card box-margin"},te={class:"card-body"},se={class:"row my-3"},le={class:"col-sm-12 col-md-5"},oe={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ne={class:"col-sm-12 col-md-7"},ie={class:"basic-table-area"},ue={class:"row my-3"},de={class:"col-sm-12 col-md-5"},re={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ce={class:"col-sm-12 col-md-7"},me={class:"dialog-footer"},_e=q({__name:"AssistantsView",setup(ve){const $=R("$formatDate"),l=W();F();const U=G(),i=u([]),o=u(B()),z=u(B());u({});const c=u(1);u(0);const A=u(["name"]),h=u(""),C=u(!1),x=u(null),v=u(-1),p=u(!1),E=K(()=>v.value===-1?"Crear Asistente":"Editar Asistente");H(h,()=>{clearTimeout(x.value),x.value=setTimeout(()=>{c.value=1,g(c.value)},600)}),J(()=>{g()});async function g(r=1){let e={page:c.value||r,search:h.value,fieldsToSearch:A.value,sort:"created_at",order:"desc"};await Promise.all([l.dispatch("assistantsModule/list",e)]);const f=l.state.assistantsModule.assistants;for(let _ of f)_.webhooks||(_.webhooks=[{headers:[],name:"main_webhook",url:""}]);i.value=l.state.assistantsModule.assistants}async function D(){if(C.value=!0,v.value>-1){let r=i.value[v.value].assistant_id;try{await l.dispatch("assistantsModule/update",{id:r,data:o.value}),Object.assign(i.value[v.value],o.value),P()}finally{C.value=!1}}else try{let r=await l.dispatch("assistantsModule/create",o.value);i.value.push(r),P(),g()}finally{C.value=!1}}function I(r){v.value=i.value.indexOf(r),o.value=Object.assign({},r),p.value=!0}async function N(r){const e=i.value.indexOf(r);let f=i.value[e].assistant_id;await X.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await l.dispatch("assistantsModule/delete",f),i.value.splice(e,1))}async function P(){p.value=!1,setTimeout(()=>{o.value=Object.assign({},z.value),v.value=-1},300)}return(r,e)=>{const f=m("el-pagination"),_=m("el-table-column"),b=m("el-input"),w=m("el-button"),O=m("el-table"),y=m("el-form-item"),j=m("el-form"),S=m("el-dialog");return L(),Q("div",Z,[n("div",ee,[n("div",ae,[n("div",te,[n("button",{type:"button",class:"btn btn-primary mb-2 mr-2",onClick:e[0]||(e[0]=a=>{P(),p.value=!0})}," Crear Asistente "),n("div",se,[n("div",le,[n("div",oe,"Mostrando "+k(d(l).state.itemsPerPage>i.value.length?i.value.length:d(l).state.itemsPerPage)+" de "+k(d(l).state.assistantsModule.total)+" registros",1)]),n("div",ne,[t(f,{"current-page":c.value,"onUpdate:currentPage":e[1]||(e[1]=a=>c.value=a),onCurrentChange:e[2]||(e[2]=a=>g(c.value)),background:"",layout:"pager",total:d(l).state.assistantsModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),n("div",ie,[M("Basic Table"),t(O,{border:"",stripe:"",data:i.value,style:{width:"100%"}},{default:s(()=>[t(_,{label:"Fecha creación",prop:"created_at"},{default:s(a=>[n("span",null,k(d($)(a.row.created_at)),1)]),_:1}),t(_,{label:"assistant_id",prop:"assistant_id"}),t(_,{label:"Nombre",prop:"name"}),t(_,{align:"right"},{header:s(()=>[t(b,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=a=>h.value=a),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:s(a=>[t(w,{size:"small",type:"primary",onClick:T=>I(a.row)},{default:s(()=>[V("Editar")]),_:2},1032,["onClick"]),t(w,{size:"small",type:"primary",color:"#5E00D9",onClick:T=>{d(U).push({path:"/assistants/statistics",query:{assistant_id:a.row.assistant_id}})}},{default:s(()=>[V("Entrenamiento")]),_:2},1032,["onClick"]),t(w,{size:"small",type:"danger",onClick:T=>N(a.row)},{default:s(()=>[V("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),M("End Basic Table")]),n("div",ue,[n("div",de,[n("div",re,"Mostrando "+k(d(l).state.itemsPerPage>i.value.length?i.value.length:d(l).state.itemsPerPage)+" de "+k(d(l).state.assistantsModule.total)+" registros",1)]),n("div",ce,[t(f,{"current-page":c.value,"onUpdate:currentPage":e[4]||(e[4]=a=>c.value=a),onCurrentChange:e[5]||(e[5]=a=>g(c.value)),background:"",layout:"pager",total:d(l).state.assistantsModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),t(S,{modelValue:p.value,"onUpdate:modelValue":e[12]||(e[12]=a=>p.value=a),title:E.value,width:"30%"},{footer:s(()=>[n("span",me,[t(w,{onClick:e[11]||(e[11]=a=>p.value=!1)},{default:s(()=>[V("Cancelar")]),_:1}),t(w,{type:"success",onClick:D,loading:C.value},{default:s(()=>[V(" Guardar ")]),_:1},8,["loading"])])]),default:s(()=>[t(j,{"label-position":"top","label-width":"100px"},{default:s(()=>[t(y,{label:"Nombre"},{default:s(()=>[t(b,{modelValue:o.value.name,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.name=a)},null,8,["modelValue"])]),_:1}),t(y,{label:"Webhook"},{default:s(()=>[t(b,{modelValue:o.value.webhooks[0].url,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.webhooks[0].url=a)},null,8,["modelValue"])]),_:1}),t(y,{label:"Bot_id relacionado"},{default:s(()=>[t(b,{modelValue:o.value.bot_id,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.bot_id=a)},null,8,["modelValue"])]),_:1}),t(y,{label:"Watson skill_id"},{default:s(()=>[t(b,{modelValue:o.value.watson_skill_id,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.watson_skill_id=a)},null,8,["modelValue"])]),_:1}),t(y,{label:"Watson api_key"},{default:s(()=>[t(b,{modelValue:o.value.watson_api_key,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.watson_api_key=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),fe=Y(_e,[["__file","D:/Programacion/Trabajo/Databot/vue3_ts_skeleton/src/views/AssistantsView.vue"]]);export{fe as default};
