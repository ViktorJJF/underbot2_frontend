import{d as F,z as T,u as G,a as A,r,m as K,o as W,n as p,b as H,c as J,f as l,q as o,s as n,i as g,D as b,t as f,h as e,e as M,G as L,E as Q,_ as X}from"./index-3d59c165.js";import{D as V}from"./Documents-06d8f6ce.js";const Y={class:"row"},Z={class:"col-12"},ee={class:"card box-margin"},te={class:"card-body"},ae={class:"row my-3"},oe={class:"col-sm-12 col-md-5"},le={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},se={class:"col-sm-12 col-md-7"},ne={class:"basic-table-area"},ie={class:"row my-3"},de={class:"col-sm-12 col-md-5"},ue={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},re={class:"col-sm-12 col-md-7"},ce={class:"dialog-footer"},me=F({__name:"index",setup(pe){const k=T("$formatDate"),B=T("$deepCopy"),s=G(),z=A();let i=r([]),c=r(V()),$=r(V());r({});let d=r(1);r(0);let E=r(["name"]),U=r(""),y=r(!1),v=r(-1),u=r(!1);const I=K(()=>v.value===-1?"Crear Documento":"Editar Documento");W(()=>{C()});async function C(m=1){let a={page:d.value||m,search:U.value,fieldsToSearch:E.value,sort:"created_at",order:"desc",limit:3e3};await Promise.all([s.dispatch("documentsModule/list",a)]),i.value=B(s.state.documentsModule.documents)}async function S(){if(y.value=!0,v.value>-1){let m=i.value[v.value].assistant_id;try{await s.dispatch("documentsModule/update",{id:m,data:c.value}),Object.assign(i.value[v.value],c.value),h()}finally{y.value=!1}}else try{let m=await s.dispatch("documentsModule/create",c.value);i.value.push(m),h(),C()}finally{y.value=!1}}async function N(m){const a=i.value.indexOf(m);let _=i.value[a]._id;await Q.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await s.dispatch("documentsModule/delete",_),i.value.splice(a,1))}async function h(){u.value=!1,setTimeout(()=>{c.value=Object.assign({},$.value),v.value=-1},300)}return(m,a)=>{const _=p("el-button"),x=p("el-pagination"),w=p("el-table-column"),O=p("el-table"),P=p("el-input"),D=p("el-form-item"),j=p("el-form"),R=p("el-dialog");return H(),J("div",Y,[l("div",Z,[l("div",ee,[l("div",te,[o(_,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:a[0]||(a[0]=t=>{h(),b(u)?u.value=!0:u=!0})},{default:n(()=>[g(" Crear Documento ")]),_:1}),l("div",ae,[l("div",oe,[l("div",le,"Mostrando "+f(e(s).state.itemsPerPage>e(i).length?e(i).length:e(s).state.itemsPerPage)+" de "+f(e(s).state.documentsModule.total)+" registros",1)]),l("div",se,[o(x,{"current-page":e(d),"onUpdate:currentPage":a[1]||(a[1]=t=>b(d)?d.value=t:d=t),onCurrentChange:a[2]||(a[2]=t=>C(e(d))),background:"",layout:"pager",total:e(s).state.documentsModule.total,"page-size":e(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),l("div",ne,[M("Basic Table"),o(O,{border:"",stripe:"",data:e(i),style:{width:"100%"}},{default:n(()=>[o(w,{label:"Fecha creación",prop:"created_at"},{default:n(t=>[l("span",null,f(e(k)(t.row.created_at)),1)]),_:1}),o(w,{label:"Tipo",prop:"type"},{default:n(t=>[l("span",null,f(t.row.type||"Sin tipo"),1)]),_:1}),o(w,{label:"Título",prop:"title"},{default:n(t=>[l("span",null,f(t.row.title||"Sin título"),1)]),_:1}),o(w,null,{default:n(t=>[o(_,{size:"small",type:"primary",onClick:q=>e(z).push({name:"DocumentsUpdate",params:{document_id:t.row._id},query:{assistant_id:e(L)()}})},{default:n(()=>[g("Editar")]),_:2},1032,["onClick"]),o(_,{size:"small",type:"danger",onClick:q=>N(t.row)},{default:n(()=>[g("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),M("End Basic Table")]),l("div",ie,[l("div",de,[l("div",ue,"Mostrando "+f(e(s).state.itemsPerPage>e(i).length?e(i).length:e(s).state.itemsPerPage)+" de "+f(e(s).state.documentsModule.total)+" registros",1)]),l("div",re,[o(x,{"current-page":e(d),"onUpdate:currentPage":a[3]||(a[3]=t=>b(d)?d.value=t:d=t),onCurrentChange:a[4]||(a[4]=t=>C(e(d))),background:"",layout:"pager",total:e(s).state.documentsModule.total,"page-size":e(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),o(R,{modelValue:e(u),"onUpdate:modelValue":a[8]||(a[8]=t=>b(u)?u.value=t:u=t),title:I.value,width:"30%"},{footer:n(()=>[l("span",ce,[o(_,{onClick:a[7]||(a[7]=t=>b(u)?u.value=!1:u=!1)},{default:n(()=>[g("Cancelar")]),_:1}),o(_,{type:"success",onClick:S,loading:e(y)},{default:n(()=>[g(" Guardar ")]),_:1},8,["loading"])])]),default:n(()=>[o(j,{"label-position":"top","label-width":"100px"},{default:n(()=>[o(D,{label:"Título"},{default:n(()=>[o(P,{modelValue:e(c).title,"onUpdate:modelValue":a[5]||(a[5]=t=>e(c).title=t)},null,8,["modelValue"])]),_:1}),o(D,{label:"Contenido"},{default:n(()=>[o(P,{type:"textarea",autosize:"",modelValue:e(c).content,"onUpdate:modelValue":a[6]||(a[6]=t=>e(c).content=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),ve=X(me,[["__file","D:/programming/Work/Databot/databot_ia_frontend/src/views/Documents/index.vue"]]);export{ve as default};
