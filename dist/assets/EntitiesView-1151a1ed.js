import{d as H,l as T,m as F,u as G,b as K,r as i,e as A,q as J,s as L,f as c,o as Q,c as W,h as o,i as a,w as s,x as y,t as f,v as d,g as E,E as X,_ as Y}from"./index-7e64b160.js";const k=()=>({entity:"",values:"",fuzzy_match:"",assistant_id:""}),Z={class:"row"},ee={class:"col-12"},te={class:"card box-margin"},ae={class:"card-body"},le={class:"row my-3"},oe={class:"col-sm-12 col-md-5"},se={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ne={class:"col-sm-12 col-md-7"},ie={class:"basic-table-area"},ue={class:"row my-3"},de={class:"col-sm-12 col-md-5"},re={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ce={class:"col-sm-12 col-md-7"},ve={class:"dialog-footer"},me=H({__name:"EntitiesView",setup(pe){const B=T("$formatDate"),$=T("$deepCopy"),l=F();G(),K();const n=i([]),v=i(k()),z=i(k());i({});const r=i(1);i(0);const D=i(["entity"]),b=i(""),h=i(!1),P=i(null),p=i(-1),_=i(!1),I=A(()=>p.value===-1?"Crear Entitiy":"Editar Entitiy");J(b,()=>{clearTimeout(P.value),P.value=setTimeout(()=>{r.value=1,g(r.value)},600)}),L(()=>{g()});async function g(u=1){let e={page:r.value||u,search:b.value,fieldsToSearch:D.value,sort:"updated_at",order:"desc"};await Promise.all([l.dispatch("entitiesModule/list",e)]),n.value=$(l.state.entitiesModule.entities)}async function N(){if(h.value=!0,p.value>-1){let u=n.value[p.value]._id;try{await l.dispatch("entitiesModule/update",{id:u,data:v.value}),Object.assign(n.value[p.value],v.value),V()}finally{h.value=!1}}else try{let u=await l.dispatch("entitiesModule/create",v.value);n.value.push(u),V(),g()}finally{h.value=!1}}function O(u){p.value=n.value.indexOf(u),v.value=Object.assign({},u),_.value=!0}async function j(u){const e=n.value.indexOf(u);let m=n.value[e]._id;await X.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await l.dispatch("entitiesModule/delete",m),n.value.splice(e,1))}async function V(){_.value=!1,setTimeout(()=>{v.value=Object.assign({},z.value),p.value=-1},300)}return(u,e)=>{const m=c("el-button"),x=c("el-pagination"),w=c("el-table-column"),M=c("el-input"),U=c("el-table"),S=c("el-form-item"),R=c("el-form"),q=c("el-dialog");return Q(),W("div",Z,[o("div",ee,[o("div",te,[o("div",ae,[a(m,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:e[0]||(e[0]=t=>{V(),_.value=!0})},{default:s(()=>[y(" Crear Entitiy ")]),_:1}),o("div",le,[o("div",oe,[o("div",se,"Mostrando "+f(d(l).state.itemsPerPage>n.value.length?n.value.length:d(l).state.itemsPerPage)+" de "+f(d(l).state.entitiesModule.total)+" registros",1)]),o("div",ne,[a(x,{"current-page":r.value,"onUpdate:currentPage":e[1]||(e[1]=t=>r.value=t),onCurrentChange:e[2]||(e[2]=t=>g(r.value)),background:"",layout:"pager",total:d(l).state.entitiesModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),o("div",ie,[E("Basic Table"),a(U,{border:"",stripe:"",data:n.value,style:{width:"100%"}},{default:s(()=>[a(w,{label:"Fecha actualización",prop:"created_at"},{default:s(t=>[o("span",null,f(d(B)(t.row.updated_at,"dd/MM/yyyy HH:mm")),1)]),_:1}),a(w,{label:"Nombre",prop:"entity"}),a(w,{label:"Valores",prop:"values"},{default:s(t=>{var C;return[o("span",null,f((C=t.row.values)==null?void 0:C.length),1)]}),_:1}),a(w,{align:"right"},{header:s(()=>[a(M,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:s(t=>[a(m,{size:"small",type:"primary",onClick:C=>O(t.row)},{default:s(()=>[y("Editar")]),_:2},1032,["onClick"]),a(m,{size:"small",type:"danger",onClick:C=>j(t.row)},{default:s(()=>[y("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),E("End Basic Table")]),o("div",ue,[o("div",de,[o("div",re,"Mostrando "+f(d(l).state.itemsPerPage>n.value.length?n.value.length:d(l).state.itemsPerPage)+" de "+f(d(l).state.entitiesModule.total)+" registros",1)]),o("div",ce,[a(x,{"current-page":r.value,"onUpdate:currentPage":e[4]||(e[4]=t=>r.value=t),onCurrentChange:e[5]||(e[5]=t=>g(r.value)),background:"",layout:"pager",total:d(l).state.entitiesModule.total,"page-size":d(l).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),a(q,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=t=>_.value=t),title:I.value,width:"30%"},{footer:s(()=>[o("span",ve,[a(m,{plain:"",type:"danger",onClick:e[7]||(e[7]=t=>_.value=!1)},{default:s(()=>[y("Cancelar")]),_:1}),a(m,{type:"success",onClick:N,loading:h.value},{default:s(()=>[y(" Guardar ")]),_:1},8,["loading"])])]),default:s(()=>[a(R,{"label-position":"top","label-width":"100px"},{default:s(()=>[a(S,{label:"Nombre"},{default:s(()=>[a(M,{modelValue:v.value.entity,"onUpdate:modelValue":e[6]||(e[6]=t=>v.value.entity=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),fe=Y(me,[["__file","D:/Programacion/Trabajo/Databot/vue3_ts_skeleton/src/views/EntitiesView.vue"]]);export{fe as default};
