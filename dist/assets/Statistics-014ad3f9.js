import{d as z,z as E,u as R,l as j,a as N,r as t,m as x,o as U,n as M,b as O,c as W,f as s,i,t as e,h as l,q as y,s as f,B as $,C as J,_ as V}from"./index-3d59c165.js";const A={class:"row"},F={class:"col-12"},q={class:"card box-margin"},I={class:"card-body"},K=s("b",null,"Asistente: ",-1),P=s("b",null,"assistant_id: ",-1),G=s("a",{id:"downloadLink",style:{display:"none"}},"Download",-1),H={class:"row mt-3"},Q={class:"col-sm-3"},X={class:"card"},Y={class:"card-body"},Z=s("h5",{class:"text-danger card-title"},"Tokens consumidos",-1),ss={class:"text-center font-30 mb-0"},ts={class:"d-flex justify-content-between mt-30"},as={class:""},os={class:""},es={class:"col-sm-3"},ns={class:"card"},is={class:"card-body"},ls=s("h5",{class:"text-danger card-title"},"Total USD",-1),cs={class:"text-center font-30 mb-0"},ds=s("i",{class:"fa fa-money text-success mr-2 font-32"},null,-1),rs=z({__name:"Statistics",setup(_s){E("$formatDate");const r=R(),T=j();N();let a=t({});t({}),t(null),t([]);const _=t(!1),p=t(!1),D=t(0),m=t(0),v=t(0),c=x(()=>T.query.assistant_id),h=x(()=>m.value+v.value);U(()=>{g()});async function g(){a.value=await r.dispatch("assistantsModule/listOne",c.value);const o=await r.dispatch("llmTrackerModule/getTotalTokens",{by:"assistant",assistant_id:c.value});m.value=o.payload.prompt_tokens,v.value=o.payload.completion_tokens,D.value+=1}async function S(){try{_.value=!0,await r.dispatch("assistantsModule/train",c.value)}catch(o){console.error(o)}finally{_.value=!1}}async function C(){try{p.value=!0,await r.dispatch("assistantsModule/generateFromWatson",c.value),g()}catch(o){console.error(o)}finally{p.value=!1}}async function B(){const u=(await $.get(J.BACKEND_BASE_URL+"/api/assistants/"+c.value,{params:{export:!0}})).data.payload,n=u.dialog_nodes;for(const b of n){const w=b.type;(w!=="frame"||w!=="standard")&&delete b.disambiguation_opt_out}u.dialog_nodes=n;const L=new Blob([JSON.stringify(u)],{type:"application/json"}),k=URL.createObjectURL(L),d=document.getElementById("downloadLink");d.href=k,d.download=`${a.value.name}.json`,d.style.display="block",d.click(),setTimeout(()=>{URL.revokeObjectURL(k),d.style.display="none"},100)}return(o,u)=>{const n=M("el-button");return O(),W("div",A,[s("div",F,[s("div",q,[s("div",I,[s("div",null,[K,i(e(l(a).name),1)]),s("div",null,[P,i(e(l(a).assistant_id),1)]),y(n,{disabled:!l(a).watson_skill_id||!l(a).watson_api_key,size:"large",type:"primary",color:"#5E00D9",onClick:C,loading:p.value},{default:f(()=>[i("Sincronizar con Watson "+e(!l(a).watson_skill_id||!l(a).watson_api_key?"(Faltan credenciales)":""),1)]),_:1},8,["disabled","loading"]),y(n,{class:"ml-3",size:"large",type:"primary",color:"#5E00D9",onClick:S,loading:_.value},{default:f(()=>[i("Train (Vectorizar)")]),_:1},8,["loading"]),y(n,{size:"large",type:"primary",color:"#5E00D9",onClick:B,loading:_.value},{default:f(()=>[i("Descargar JSON")]),_:1},8,["loading"]),G,s("div",H,[s("div",Q,[s("div",X,[s("div",Y,[Z,s("h4",ss,e(h.value),1),s("div",ts,[s("p",as,"Prompt Tokens: "+e(m.value),1),s("p",os,"Completion Tokens: "+e(v.value),1)])])])]),s("div",es,[s("div",ns,[s("div",is,[ls,s("h4",cs,[ds,i("$"+e((h.value/1e3*.002).toFixed(3)),1)])])])])])])])])])}}}),ps=V(rs,[["__file","D:/programming/Work/Databot/databot_ia_frontend/src/views/Statistics.vue"]]);export{ps as default};
