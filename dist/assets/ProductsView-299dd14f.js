import{d as G,z as B,u as K,l as W,a as J,r as i,m as L,A as Q,o as X,n as m,b as w,c as y,f as o,q as a,s as l,i as u,t as _,h as d,e as z,E as Y,_ as Z}from"./index-3d59c165.js";const D=()=>({bot_id:0,assistant_id:"",domain:"",sku:"",name:"",categories:[],description:"",price:0,offer_price:0,currency:"",image_url:"",product_url:"",product_id:"",available:!0,stock:0,options:[],variants:[],reviews:[],general_rating:0,original_object:{},intent:"",examples:""}),ee={class:"row"},te={class:"col-12"},ae={class:"card box-margin"},oe={class:"card-body"},le={class:"row my-3"},se={class:"col-sm-12 col-md-5"},ne={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ie={class:"col-sm-12 col-md-7"},re={class:"basic-table-area"},de=["src"],ue=["href"],ce={key:0},pe={key:0},_e={key:1},me={key:1},ve={class:"row my-3"},ge={class:"col-sm-12 col-md-5"},fe={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},be={class:"col-sm-12 col-md-7"},he={class:"dialog-footer"},we=G({__name:"ProductsView",setup(ye){const I=B("$formatDate"),E=B("$deepCopy"),s=K();W(),J();const n=i([]),v=i(D()),N=i(D());i({});const c=i(1);i(0);const O=i(["name","categories","description"]),C=i(""),k=i(!1),x=i(null),f=i(-1),P=i({}),b=i(!1),S=L(()=>f.value===-1?"Crear Product":"Editar Product");Q(C,()=>{clearTimeout(x.value),x.value=setTimeout(()=>{c.value=1,h(c.value)},600)}),X(()=>{h()});async function h(r=1){let t={page:c.value||r,search:C.value,fieldsToSearch:O.value,sort:"updated_at",order:"desc"};await Promise.all([s.dispatch("productsModule/list",t)]),n.value=E(s.state.productsModule.products)}async function j(){if(k.value=!0,f.value>-1){let r=n.value[f.value]._id;try{await s.dispatch("productsModule/update",{id:r,data:v.value}),Object.assign(n.value[f.value],v.value),V()}finally{k.value=!1}}else try{let r=await s.dispatch("productsModule/create",v.value);n.value.push(r),V(),h()}finally{k.value=!1}}function U(r){f.value=n.value.indexOf(r),v.value=Object.assign({},r),b.value=!0}async function R(r){const t=n.value.indexOf(r);let p=n.value[t]._id;await Y.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await s.dispatch("productsModule/delete",p),n.value.splice(t,1))}async function V(){b.value=!1,setTimeout(()=>{v.value=Object.assign({},N.value),f.value=-1},300)}return(r,t)=>{const p=m("el-button"),T=m("el-pagination"),g=m("el-table-column"),$=m("el-input"),q=m("el-table"),H=m("el-form-item"),A=m("el-form"),F=m("el-dialog");return w(),y("div",ee,[o("div",te,[o("div",ae,[o("div",oe,[a(p,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:t[0]||(t[0]=e=>{V(),b.value=!0})},{default:l(()=>[u(" Crear Producto ")]),_:1}),o("div",le,[o("div",se,[o("div",ne,"Mostrando "+_(d(s).state.itemsPerPage>n.value.length?n.value.length:d(s).state.itemsPerPage)+" de "+_(d(s).state.productsModule.total)+" registros",1)]),o("div",ie,[a(T,{"current-page":c.value,"onUpdate:currentPage":t[1]||(t[1]=e=>c.value=e),onCurrentChange:t[2]||(t[2]=e=>h(c.value)),background:"",layout:"pager",total:d(s).state.productsModule.total,"page-size":d(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),o("div",re,[z("Basic Table"),a(q,{border:"",stripe:"",data:n.value,style:{width:"100%"}},{default:l(()=>[a(g,{label:"Fecha actualización",prop:"created_at"},{default:l(e=>[o("span",null,_(d(I)(e.row.updated_at,"dd/MM/yyyy HH:mm")),1)]),_:1}),a(g,{label:"Imagen",prop:"image_url"},{default:l(e=>[o("img",{src:e.row.image_url,alt:"Imagen",width:"100",height:"100"},null,8,de)]),_:1}),a(g,{label:"Nombre",prop:"name"},{default:l(e=>[o("span",null,_(e.row.name),1),u(" link "),o("div",null,[o("a",{href:e.row.product_url,target:"_blank"},"Ver",8,ue)])]),_:1}),a(g,{label:"Categorías",prop:"categories"}),a(g,{label:"Descripción"},{default:l(e=>[e.row.description.length>50?(w(),y("div",ce,[P.value[e.row._id]?(w(),y("div",pe,[u(_(e.row.description)+" ",1),a(p,{onClick:M=>P.value[e.row._id]=!1},{default:l(()=>[u("Show less")]),_:2},1032,["onClick"])])):(w(),y("div",_e,[u(_(e.row.description.substring(0,50))+"... ",1),a(p,{onClick:M=>P.value[e.row._id]=!0},{default:l(()=>[u("Show more")]),_:2},1032,["onClick"])]))])):(w(),y("div",me,_(e.row.description),1))]),_:1}),a(g,{label:"Disponible",prop:"available"}),a(g,{align:"right"},{header:l(()=>[a($,{modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=e=>C.value=e),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:l(e=>[a(p,{size:"small",type:"primary",onClick:M=>U(e.row)},{default:l(()=>[u("Editar")]),_:2},1032,["onClick"]),a(p,{size:"small",type:"danger",onClick:M=>R(e.row)},{default:l(()=>[u("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),z("End Basic Table")]),o("div",ve,[o("div",ge,[o("div",fe,"Mostrando "+_(d(s).state.itemsPerPage>n.value.length?n.value.length:d(s).state.itemsPerPage)+" de "+_(d(s).state.productsModule.total)+" registros",1)]),o("div",be,[a(T,{"current-page":c.value,"onUpdate:currentPage":t[4]||(t[4]=e=>c.value=e),onCurrentChange:t[5]||(t[5]=e=>h(c.value)),background:"",layout:"pager",total:d(s).state.productsModule.total,"page-size":d(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),a(F,{modelValue:b.value,"onUpdate:modelValue":t[8]||(t[8]=e=>b.value=e),title:S.value,width:"30%"},{footer:l(()=>[o("span",he,[a(p,{plain:"",type:"danger",onClick:t[7]||(t[7]=e=>b.value=!1)},{default:l(()=>[u("Cancelar")]),_:1}),a(p,{type:"success",onClick:j,loading:k.value},{default:l(()=>[u(" Guardar ")]),_:1},8,["loading"])])]),default:l(()=>[a(A,{"label-position":"top","label-width":"100px"},{default:l(()=>[a(H,{label:"Nombre"},{default:l(()=>[a($,{modelValue:v.value.name,"onUpdate:modelValue":t[6]||(t[6]=e=>v.value.name=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),ke=Z(we,[["__file","D:/programming/Work/Databot/databot_ia_frontend/src/views/ProductsView.vue"]]);export{ke as default};
