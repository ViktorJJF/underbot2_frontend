import{d as K,l as B,m as A,u as J,b as L,r as i,e as Q,q as W,s as X,f as m,o as h,c as y,h as o,i as a,w as l,x as u,t as p,v as d,g as z,E as Y,_ as Z}from"./index-c643d5de.js";const D=()=>({bot_id:0,assistant_id:"",domain:"",sku:"",name:"",categories:[],description:"",price:0,offer_price:0,currency:"",image_url:"",product_url:"",product_id:"",available:!0,stock:0,options:[],variants:[],reviews:[],general_rating:0,original_object:{},intent:"",examples:""}),ee={class:"row"},te={class:"col-12"},ae={class:"card box-margin"},oe={class:"card-body"},le={class:"row my-3"},se={class:"col-sm-12 col-md-5"},ne={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},ie={class:"col-sm-12 col-md-7"},re={class:"basic-table-area"},de=["src"],ue=["href"],ce={key:0},_e={key:0},pe={key:1},me={key:1},ve={class:"row my-3"},ge={class:"col-sm-12 col-md-5"},fe={class:"dataTables_info",id:"datatable-buttons_info",role:"status","aria-live":"polite"},be={class:"col-sm-12 col-md-7"},we={class:"dialog-footer"},he=K({__name:"ProductsView",setup(ye){const I=B("$formatDate"),E=B("$deepCopy"),s=A();J(),L();const n=i([]),v=i(D()),j=i(D());i({});const c=i(1);i(0);const N=i(["name","categories","description"]),C=i(""),k=i(!1),M=i(null),g=i(-1),P=i({}),f=i(!1),O=Q(()=>g.value===-1?"Crear Product":"Editar Product");W(C,()=>{clearTimeout(M.value),M.value=setTimeout(()=>{c.value=1,w(c.value)},600)}),X(()=>{w()});async function w(r=1){let t={page:c.value||r,search:C.value,fieldsToSearch:N.value,sort:"updated_at",order:"desc"};await Promise.all([s.dispatch("productsModule/list",t)]),n.value=E(s.state.productsModule.products)}async function S(){if(k.value=!0,g.value>-1){let r=n.value[g.value]._id;try{await s.dispatch("productsModule/update",{id:r,data:v.value}),Object.assign(n.value[g.value],v.value),V()}finally{k.value=!1}}else try{let r=await s.dispatch("productsModule/create",v.value);n.value.push(r),V(),w()}finally{k.value=!1}}function U(r){g.value=n.value.indexOf(r),v.value=Object.assign({},r),f.value=!0}async function R(r){const t=n.value.indexOf(r);let _=n.value[t]._id;await Y.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await s.dispatch("productsModule/delete",_),n.value.splice(t,1))}async function V(){f.value=!1,setTimeout(()=>{v.value=Object.assign({},j.value),g.value=-1},300)}return(r,t)=>{const _=m("el-button"),T=m("el-pagination"),b=m("el-table-column"),$=m("el-input"),q=m("el-table"),H=m("el-form-item"),F=m("el-form"),G=m("el-dialog");return h(),y("div",ee,[o("div",te,[o("div",ae,[o("div",oe,[a(_,{type:"primary",color:"#5E00D9",class:"mb-2",onClick:t[0]||(t[0]=e=>{V(),f.value=!0})},{default:l(()=>[u(" Crear Producto ")]),_:1}),o("div",le,[o("div",se,[o("div",ne,"Mostrando "+p(d(s).state.itemsPerPage>n.value.length?n.value.length:d(s).state.itemsPerPage)+" de "+p(d(s).state.productsModule.total)+" registros",1)]),o("div",ie,[a(T,{"current-page":c.value,"onUpdate:currentPage":t[1]||(t[1]=e=>c.value=e),onCurrentChange:t[2]||(t[2]=e=>w(c.value)),background:"",layout:"pager",total:d(s).state.productsModule.total,"page-size":d(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])]),o("div",re,[z("Basic Table"),a(q,{border:"",stripe:"",data:n.value,style:{width:"100%"}},{default:l(()=>[a(b,{label:"Fecha actualización",prop:"created_at"},{default:l(e=>[o("span",null,p(d(I)(e.row.updated_at,"dd/MM/yyyy HH:mm")),1)]),_:1}),a(b,{label:"Imagen",prop:"image_url"},{default:l(e=>[o("img",{src:e.row.image_url,alt:"Imagen",width:"100",height:"100"},null,8,de)]),_:1}),a(b,{label:"Nombre",prop:"name"},{default:l(e=>[o("span",null,p(e.row.name),1),u(" link "),o("div",null,[o("a",{href:e.row.product_url,target:"_blank"},"Ver",8,ue)])]),_:1}),a(b,{label:"Categorías",prop:"categories"}),a(b,{label:"Descripción"},{default:l(e=>[e.row.description.length>50?(h(),y("div",ce,[P.value[e.row._id]?(h(),y("div",_e,[u(p(e.row.description)+" ",1),a(_,{onClick:x=>P.value[e.row._id]=!1},{default:l(()=>[u("Show less")]),_:2},1032,["onClick"])])):(h(),y("div",pe,[u(p(e.row.description.substring(0,50))+"... ",1),a(_,{onClick:x=>P.value[e.row._id]=!0},{default:l(()=>[u("Show more")]),_:2},1032,["onClick"])]))])):(h(),y("div",me,p(e.row.description),1))]),_:1}),a(b,{align:"right"},{header:l(()=>[a($,{modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=e=>C.value=e),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:l(e=>[a(_,{size:"small",type:"primary",onClick:x=>U(e.row)},{default:l(()=>[u("Editar")]),_:2},1032,["onClick"]),a(_,{size:"small",type:"danger",onClick:x=>R(e.row)},{default:l(()=>[u("Borrar")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),z("End Basic Table")]),o("div",ve,[o("div",ge,[o("div",fe,"Mostrando "+p(d(s).state.itemsPerPage>n.value.length?n.value.length:d(s).state.itemsPerPage)+" de "+p(d(s).state.productsModule.total)+" registros",1)]),o("div",be,[a(T,{"current-page":c.value,"onUpdate:currentPage":t[4]||(t[4]=e=>c.value=e),onCurrentChange:t[5]||(t[5]=e=>w(c.value)),background:"",layout:"pager",total:d(s).state.productsModule.total,"page-size":d(s).state.itemsPerPage},null,8,["current-page","total","page-size"])])])])])]),a(G,{modelValue:f.value,"onUpdate:modelValue":t[8]||(t[8]=e=>f.value=e),title:O.value,width:"30%"},{footer:l(()=>[o("span",we,[a(_,{plain:"",type:"danger",onClick:t[7]||(t[7]=e=>f.value=!1)},{default:l(()=>[u("Cancelar")]),_:1}),a(_,{type:"success",onClick:S,loading:k.value},{default:l(()=>[u(" Guardar ")]),_:1},8,["loading"])])]),default:l(()=>[a(F,{"label-position":"top","label-width":"100px"},{default:l(()=>[a(H,{label:"Nombre"},{default:l(()=>[a($,{modelValue:v.value.name,"onUpdate:modelValue":t[6]||(t[6]=e=>v.value.name=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}}),ke=Z(he,[["__file","D:/Programacion/Trabajo/Databot/vue3_ts_skeleton/src/views/ProductsView.vue"]]);export{ke as default};
